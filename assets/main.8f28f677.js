import"https://unpkg.com/@workadventure/scripting-api-extra@^1";WA.onInit().then(()=>{for(var o=[],a=[],r=36;r<=42;r++)o.push([r,18]),a.push([r,19]);o.push([44,18]),o.push([45,18]),a.push([44,19]),t(a,o,"fence","block","Special/Block"),t(o,[],"fence","fence_c","above_player_1"),t([[42,18],[45,18]],[],"fence","fence_r","above_player_1"),t([[37,18],[39,18],[41,18]],[],"fence","bench_u","above_player_3"),t([[38,18],[40,18],[42,18]],[],"fence","flag_u","above_player_3"),u()});function u(){WA.controls.disablePlayerControls(),i()}async function i(o=0){for(var a=[69,26],r=69*4+2,n=34+3,l=0;l<6;l++)for(var e=0;e<3;e++)WA.room.setTiles([{x:a[0]-parseInt(o/4)+l,y:a[1]+e,tile:1+l+30*e+o%4*6,layer:"train"}]);if(o%4==0)for(var e=0;e<3;e++)WA.room.setTiles([{x:a[0]-parseInt(o/4)+6,y:a[1]+e,tile:null,layer:"train"}]);var c=f(n-o/4,0,4)*100;if(o/4==n){c=2e3;var s=await WA.player.getPosition();console.log(s),await WA.player.moveTo(s.x,s.y-100,10),setTimeout(function(){WA.room.setTiles([{x:35,y:27,tile:"block",layer:"Special/Block"}]),WA.controls.restorePlayerControls(),WA.ui.displayBubble("Welcome to the station!","Welcome to the station!",[{label:"OK",className:"primary",callback:m=>{WA.ui.closeBubble()}}])},1e3)}o<r&&setTimeout(function(){i(o+1)},c)}function f(o,a,r){return Math.exp(-Math.pow(o-a,2)/(2*Math.pow(r,2)))}function t(o,a,r,n,l){WA.room.area.onEnter(r).subscribe(()=>{o.forEach(function(e){WA.room.setTiles([{x:e[0],y:e[1],tile:n,layer:l}])}),a.forEach(function(e){WA.room.setTiles([{x:e[0],y:e[1],tile:null,layer:l}])})}),WA.room.area.onLeave(r).subscribe(()=>{a.forEach(function(e){WA.room.setTiles([{x:e[0],y:e[1],tile:n,layer:l}])}),o.forEach(function(e){WA.room.setTiles([{x:e[0],y:e[1],tile:null,layer:l}])})})}
